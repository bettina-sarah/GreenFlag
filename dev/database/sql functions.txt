func select_image_by_label_and_transformation (_label_id,_translated, _rotated, _scaled, _exclusive)
    SELECT * 
        FROM klustr.image_list_info 
        WHERE label_id = _label_id
            AND CASE 
                    WHEN _exclusive THEN
                        translation = _translated AND
                        rotation = _rotated AND
                        scale = _scaled
                    ELSE
                        (translation = _translated OR _translated) AND
                        (rotation = _rotated OR _rotated) AND
                        (scale = _scaled OR _scaled)
                END


____________________________________________________________
func select_image_from_data_set( _data_set_name, _training_data_set)

BEGIN
    IF _training_data_set THEN 
        RETURN QUERY 
            SELECT inf.*
                FROM klustr.data_set AS ds
                    JOIN klustr.data_set_training AS dst
                        ON dst.data_set = ds.id
                    JOIN klustr.image_list_info AS inf
                        ON dst.image = inf.image_id
                WHERE ds.name = _data_set_name;	
    ELSE
        RETURN QUERY 
            SELECT inf.*
                FROM klustr.data_set AS ds
                    JOIN klustr.data_set_test AS dst
                        ON dst.data_set = ds.id
                    JOIN klustr.image_list_info AS inf
                        ON dst.image = inf.image_id
                WHERE ds.name = _data_set_name;	    
    END IF;
END

____________________________________________________________
func select_label_from_data_set ( _data_set_name)

    SELECT  lbl.id AS label_id, 
            (SELECT name FROM klustr.label WHERE id = lbl.id) AS label_name,
            (SELECT img.img_thumbnail 
                FROM klustr.image AS img 
                WHERE id = lbl.id
                    AND img.translation = FALSE
                    AND img.rotation = FALSE
                    AND img.scale = FALSE) AS label_thumbnail
        FROM klustr.data_set AS ds
            JOIN klustr.data_set_training AS dst
                ON dst.data_set = ds.id
            JOIN klustr.image AS img
                ON dst.image = img.id
            JOIN klustr.label AS lbl
                on img.label = lbl.id
        WHERE ds.name = _data_set_name 
        GROUP BY lbl.id
        ORDER BY label_name;
